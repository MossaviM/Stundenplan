<!doctype html>
<html lang="de">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Stundenplan</title>
  <style>
    :root{
      --bg:#0f172a;
      --panel:#111827;
      --muted:#94a3b8;
      --text:#e5e7eb;
      --accent:#22c55e;
      --accent-2:#3b82f6;
      --danger:#ef4444;
      --border:#1f2937;
      --hover:#0b1224;
      --chip:#0b1224;
      --shadow:0 10px 30px rgba(0,0,0,.35);
      --radius:14px;
      --cell-radius:10px;
    }
    * { box-sizing: border-box }
    html,body { height:100% }
    body{
      margin:0;
      font-family: system-ui, -apple-system, Segoe UI, Roboto, Ubuntu, Cantarell, "Helvetica Neue", Arial;
      color:var(--text);
      background: radial-gradient(1200px 600px at 30% -10%, #1e293b 0%, #0f172a 52%, #0b1022 100%);
      line-height:1.45;
    }
    header{
      position:sticky; top:0; z-index:20;
      backdrop-filter:saturate(140%) blur(10px);
      background:linear-gradient(180deg, rgba(15,23,42,0.9) 0%, rgba(15,23,42,0.6) 100%);
      border-bottom:1px solid var(--border);
    }
    .wrap{ max-width:1100px; margin:0 auto; padding:16px 20px; }
    h1{ margin:6px 0 2px; font-size:22px; }
    .sub{ color:var(--muted); font-size:14px; margin-top:6px }
    .toolbar{ display:flex; flex-wrap:wrap; gap:10px; align-items:center; margin-top:12px }
    button, .button{
      appearance:none; border:1px solid var(--border); color:var(--text);
      background:linear-gradient(180deg,#111827,#0b1224);
      padding:10px 14px; border-radius:10px; cursor:pointer;
      box-shadow: inset 0 1px 0 rgba(255,255,255,.03), var(--shadow);
      font-weight:600; font-size:14px;
      transition:transform .04s ease, background .2s ease, border-color .2s ease;
    }
    button:hover{ background:#10182d; transform:translateY(-1px) }
    .accent{ border-color:rgba(59,130,246,.35) }
    .danger{ border-color:rgba(239,68,68,.35) }
    .ghost { background:transparent; box-shadow:none }
    input, select{
      width:100%; padding:10px 12px; border-radius:10px;
      border:1px solid var(--border); background:#0b1224; color:var(--text);
      outline:none;
    }
    .grid{ margin:22px auto; width:100%; display:grid; gap:8px;
      grid-template-columns: 120px repeat(5, 1fr); }
    .cell, .head, .time-col{
      background:linear-gradient(180deg,#0f172a,#0b1224);
      border:1px solid var(--border); border-radius:var(--cell-radius);
      padding:10px; min-height:68px; position:relative;
    }
    .head{ font-weight:700; text-align:center; min-height:44px;
      display:flex; align-items:center; justify-content:center; }
    .lesson{ background:var(--chip); border:1px solid var(--border);
      padding:10px; border-radius:8px; box-shadow: inset 0 1px 0 rgba(255,255,255,.03); }
    .lesson strong{ display:block; font-size:14px; margin-bottom:4px }
    .lesson small{ font-size:12px; color:var(--muted) }
    @media print{
      header, .toolbar{ display:none !important }
      body{ background:white; color:black }
      .cell, .head{ border-color:#ddd; background:white; color:black }
      .lesson{ background:#f7f7f7; border-color:#ddd; color:black }
    }
  </style>
</head>
<body>
  <header>
    <div class="wrap">
      <h1>Stundenplan</h1>
      <div class="sub" id="currentLessonText">Lade aktuellen Stand …</div>
      <div class="toolbar">
        <button id="btnReset" class="danger">Plan zurücksetzen</button>
        <button onclick="window.print()">Drucken</button>
      </div>
    </div>
  </header>

  <main class="wrap">
    <div id="grid" class="grid"></div>
  </main>

  <script>
    const days = ["Montag","Dienstag","Mittwoch","Donnerstag","Freitag"];
    const hours = [8,9,10,11,12,13];

    function firstLoginSetup() {
      if (!localStorage.getItem("schedule")) {
        alert("Willkommen! Bitte gib deinen Stundenplan ein (Montag–Freitag, 8–13 Uhr).");
        let schedule = {};
        days.forEach(day => {
          schedule[day] = {};
          hours.forEach(hour => {
            let subj = prompt(`${day}, ${hour}:00 Uhr – Fach eingeben (z. B. Mathe, frei)`);
            let teacher = subj ? prompt(`Lehrkraft für ${subj} (${day}, ${hour}:00 Uhr):`) : "";
            let room = subj ? prompt(`Raum für ${subj} (${day}, ${hour}:00 Uhr):`) : "";
            schedule[day][hour] = { subject: subj || "frei", teacher, room };
          });
        });
        localStorage.setItem("schedule", JSON.stringify(schedule));
      }
    }

    function getSchedule() {
      return JSON.parse(localStorage.getItem("schedule")) || {};
    }

    function renderGrid() {
      const grid = document.getElementById("grid");
      grid.innerHTML = "";
      // Kopfzeile
      grid.appendChild(makeCell("Zeit", "head"));
      days.forEach(d => grid.appendChild(makeCell(d, "head")));
      // Stunden
      hours.forEach(h => {
        grid.appendChild(makeCell(h+":00", "head"));
        days.forEach(d => {
          let entry = getSchedule()[d][h];
          let div = document.createElement("div");
          div.className = "cell";
          if (entry && entry.subject && entry.subject !== "frei") {
            div.innerHTML = `<div class="lesson">
              <strong>${entry.subject}</strong>
              <small>${entry.teacher || ""} ${entry.room || ""}</small>
            </div>`;
          } else {
            div.innerHTML = `<div class="lesson"><small>frei</small></div>`;
          }
          grid.appendChild(div);
        });
      });
    }

    function makeCell(text, cls="cell") {
      let div = document.createElement("div");
      div.className = cls;
      div.textContent = text;
      return div;
    }

    function getCurrentLesson() {
      let schedule = getSchedule();
      let now = new Date();
      let weekday = now.getDay(); // 1=Mo
      let hour = now.getHours();
      if (weekday < 1 || weekday > 5 || hour < 8 || hour > 13) {
        return "Gerade keine Unterrichtszeit.";
      }
      let dayName = days[weekday-1];
      let entry = schedule[dayName][hour];
      if (!entry || entry.subject==="frei") {
        return `Heute ist ${dayName}, ${hour}:00 Uhr – keine Stunde.`;
      }
      return `Heute ist ${dayName}, ${hour}:00 Uhr – Fach: ${entry.subject}` +
        (entry.teacher? ` bei ${entry.teacher}`:"") +
        (entry.room? ` in Raum ${entry.room}`:"") + ".";
    }

    // Initialisierung
    firstLoginSetup();
    renderGrid();
    document.getElementById("currentLessonText").innerText = getCurrentLesson();

    // Reset
    document.getElementById("btnReset").addEventListener("click", () => {
      if (confirm("Plan wirklich zurücksetzen?")) {
        localStorage.removeItem("schedule");
        location.reload();
      }
    });
  </script>
</body>
</html>
